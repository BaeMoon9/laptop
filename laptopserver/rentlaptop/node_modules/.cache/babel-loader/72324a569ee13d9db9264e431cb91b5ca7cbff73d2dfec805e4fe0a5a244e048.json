{"ast":null,"code":"import{Table}from'react-bootstrap';import axios from'axios';import React,{useState,useEffect}from\"react\";import Badge from'react-bootstrap/Badge';import{utils,writeFile}from\"xlsx\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ListTable(){const[laptopData,setLaptopData]=useState([]);const[excelExport,setExcelExport]=useState([]);useEffect(()=>{axios.get('http://localhost:8081/laptopdatabases').then(result=>{setLaptopData(result.data);console.log(laptopData);}).catch(()=>{console.log('failed');});},[]);// console.log(laptopData)\n// console.log(laptopData[0])\nfunction excelExportHandler(){const xlsx=require('xlsx-js-style');//시트 스타일 모듈\nconst excelTableHeader=[[\"상품명\",\"물품번호\",\"학번\",\"이름\",\"상태\"]];const wb=xlsx.utils.book_new();//엑셀 문서 만들기\nconst ws=xlsx.utils.json_to_sheet([]);//열 순서 시트화\nutils.sheet_add_aoa(ws,excelTableHeader);ws[\"!cols\"]=[//엑셀 칼럼 넓이 A, B, C, D, E열\n{wpx:120,alignment:{font:{name:\"Courier\",sz:24}}},{wpx:180,alignment:{font:{name:\"Courier\",sz:24}}},{wpx:120,alignment:{font:{name:\"Courier\",sz:24}}},{wpx:120,alignment:{font:{name:\"Courier\",sz:24}}},{wpx:120,alignment:{font:{name:\"Courier\",sz:24}}}];ws[(\"A1\",\"B1\",\"C1\",\"D1\",\"E1\")].s={font:{sz:18,bold:true,color:{rgb:\"3300CC\"}}};if(laptopData.length>1){for(let i in laptopData){const datas={laptopName:laptopData[i].name,laptopNum:laptopData[i].ync_num,stuNum:laptopData[i].rent_student_id,stuName:laptopData[i].rent_name,status:laptopData[i].status};excelExport.push(datas);}}utils.sheet_add_json(ws,excelExport,{origin:\"A2\",skipHeader:true});utils.book_append_sheet(wb,ws,\"laptoplist\");writeFile(wb,\"laptoplist_.xlsx\");setExcelExport([]);//엑셀 데이터 담은 배열 초기화\n}return/*#__PURE__*/_jsxs(\"div\",{className:\"listtable\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"listtop\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"registertitle\",children:\"\\uB178\\uD2B8\\uBD81 \\uBAA9\\uB85D\"}),/*#__PURE__*/_jsx(\"button\",{className:\"excelBtn\",onClick:excelExportHandler,children:\"\\uB0B4\\uBCF4\\uB0B4\\uAE30\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"tables\",children:/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{class:\"col-md-1\",children:\"\\uC21C\\uBC88\"}),/*#__PURE__*/_jsx(\"th\",{class:\"col-md-1\",children:\"\\uC0C1\\uD488\\uBA85\"}),/*#__PURE__*/_jsx(\"th\",{class:\"col-md-2\",children:\"\\uBB3C\\uD488\\uBC88\\uD638\"}),/*#__PURE__*/_jsx(\"th\",{class:\"col-md-1\",children:\"\\uD559\\uBC88\"}),/*#__PURE__*/_jsx(\"th\",{class:\"col-md-1\",children:\"\\uC774\\uB984\"}),/*#__PURE__*/_jsx(\"th\",{class:\"col-md-1\",children:\"\\uC0C1\\uD0DC\"}),/*#__PURE__*/_jsx(\"th\",{class:\"col-md-1\",children:\"\\uBE44\\uACE0\"})]})}),laptopData.map((a,inx)=>/*#__PURE__*/_jsx(\"tbody\",{className:\"tbody1\",children:/*#__PURE__*/_jsxs(\"tr\",{className:\"tr1\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"td1\",children:inx+1}),/*#__PURE__*/_jsx(\"td\",{className:\"td1\",children:a.name}),/*#__PURE__*/_jsx(\"td\",{className:\"td1\",children:a.ync_num}),/*#__PURE__*/_jsx(\"td\",{className:\"td1\",children:a.rent_student_id}),/*#__PURE__*/_jsx(\"td\",{className:\"td1\",children:a.rent_name}),/*#__PURE__*/_jsx(\"td\",{className:\"td1\",children:a.status==='대여가능'?/*#__PURE__*/_jsx(Badge,{bg:\"success\",className:\"badgeCss\",children:\"\\uB300\\uC5EC\\uAC00\\uB2A5\"}):/*#__PURE__*/_jsx(Badge,{bg:\"danger\",className:\"badgeCss\",children:\"\\uB300\\uC5EC\\uBD88\\uAC00\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"td1\",children:a.status})]})},inx))]})})]});}export default ListTable;","map":{"version":3,"names":["Table","axios","React","useState","useEffect","Badge","utils","writeFile","jsx","_jsx","jsxs","_jsxs","ListTable","laptopData","setLaptopData","excelExport","setExcelExport","get","then","result","data","console","log","catch","excelExportHandler","xlsx","require","excelTableHeader","wb","book_new","ws","json_to_sheet","sheet_add_aoa","wpx","alignment","font","name","sz","s","bold","color","rgb","length","i","datas","laptopName","laptopNum","ync_num","stuNum","rent_student_id","stuName","rent_name","status","push","sheet_add_json","origin","skipHeader","book_append_sheet","className","children","onClick","striped","bordered","hover","class","map","a","inx","bg"],"sources":["/Users/baemungyu/Documents/Github/server/rentlaptop/src/pages/list.js"],"sourcesContent":["import { Table } from 'react-bootstrap';\nimport axios from 'axios'\nimport React, { useState, useEffect } from \"react\";\nimport Badge from 'react-bootstrap/Badge';\nimport { utils, writeFile } from \"xlsx\";\n\nfunction ListTable() {\n\n\tconst [laptopData, setLaptopData] = useState([])\n\tconst [excelExport, setExcelExport] = useState([])\n\n\tuseEffect(() => {\n\t\taxios.get('http://localhost:8081/laptopdatabases').then((result) => {\n\t\t\tsetLaptopData(result.data)\n\t\t\tconsole.log(laptopData)\n\t\t}).catch(() => {\n\t\t\tconsole.log('failed')\n\t\t})\n\t}, [])\n\n\t// console.log(laptopData)\n\t// console.log(laptopData[0])\n\n\tfunction excelExportHandler() {\n\t\tconst xlsx = require('xlsx-js-style') //시트 스타일 모듈\n\t\tconst excelTableHeader = [[\"상품명\", \"물품번호\", \"학번\", \"이름\", \"상태\"]]\n\t\tconst wb = xlsx.utils.book_new() //엑셀 문서 만들기\n\t\tconst ws = xlsx.utils.json_to_sheet([]) //열 순서 시트화\n\t\tutils.sheet_add_aoa(ws, excelTableHeader)\n\n\t\tws[\"!cols\"] = [ //엑셀 칼럼 넓이 A, B, C, D, E열\n\t\t\t{wpx : 120, alignment : { font: { name: \"Courier\", sz: 24 } }},\n\t\t\t{wpx : 180, alignment : { font: { name: \"Courier\", sz: 24 } }},\n\t\t\t{wpx : 120, alignment : { font: { name: \"Courier\", sz: 24 } }},\n\t\t\t{wpx : 120, alignment : { font: { name: \"Courier\", sz: 24 } }},\n\t\t\t{wpx : 120, alignment : { font: { name: \"Courier\", sz: 24 } }},\n\t\t]\n\n\t\tws[\"A1\", \"B1\", \"C1\", \"D1\", \"E1\"].s = {\n\t\t\tfont: {\n\t\t\t\tsz: 18,\n\t\t\t\tbold: true,\n\t\t\t\tcolor: {rgb: \"3300CC\"}\n\t\t\t}\n\t\t}\n\n\t\n\n\t\tif (laptopData.length > 1) {\n\t\t\tfor (let i in laptopData) {\n\t\t\t\tconst datas = {\n\t\t\t\t\tlaptopName: laptopData[i].name,\n\t\t\t\t\tlaptopNum: laptopData[i].ync_num,\n\t\t\t\t\tstuNum: laptopData[i].rent_student_id,\n\t\t\t\t\tstuName: laptopData[i].rent_name,\n\t\t\t\t\tstatus: laptopData[i].status\n\t\t\t\t}\n\t\t\t\texcelExport.push(datas)\n\t\t\t}\n\t\t}\n\t\tutils.sheet_add_json(ws, excelExport, { origin: \"A2\", skipHeader: true })\n\t\tutils.book_append_sheet(wb, ws, \"laptoplist\")\n\t\twriteFile(wb, `laptoplist_.xlsx`);\n\t\tsetExcelExport([]) //엑셀 데이터 담은 배열 초기화\n\t}\n\n\treturn (\n\t\t<div className=\"listtable\">\n\t\t\t<div className=\"listtop\">\n\t\t\t\t<div className=\"registertitle\">\n\t\t\t\t\t노트북 목록\n\t\t\t\t</div>\n\t\t\t\t<button className=\"excelBtn\" onClick={excelExportHandler}>내보내기</button>\n\t\t\t</div>\n\t\t\t<div className=\"tables\">\n\t\t\t\t<Table striped bordered hover>\n\t\t\t\t\t<thead>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<th class=\"col-md-1\">순번</th>\n\t\t\t\t\t\t\t<th class=\"col-md-1\">상품명</th>\n\t\t\t\t\t\t\t<th class=\"col-md-2\">물품번호</th>\n\t\t\t\t\t\t\t<th class=\"col-md-1\">학번</th>\n\t\t\t\t\t\t\t<th class=\"col-md-1\">이름</th>\n\t\t\t\t\t\t\t<th class=\"col-md-1\">상태</th>\n\t\t\t\t\t\t\t<th class=\"col-md-1\">비고</th>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</thead>\n\t\t\t\t\t{\n\t\t\t\t\t\tlaptopData.map((a, inx) => (\n\t\t\t\t\t\t\t<tbody key={inx} className='tbody1'>\n\t\t\t\t\t\t\t\t<tr className='tr1'>\n\t\t\t\t\t\t\t\t\t<td className='td1'>{inx + 1}</td>\n\t\t\t\t\t\t\t\t\t<td className='td1'>{a.name}</td>\n\t\t\t\t\t\t\t\t\t<td className='td1'>{a.ync_num}</td>\n\t\t\t\t\t\t\t\t\t<td className='td1'>{a.rent_student_id}</td>\n\t\t\t\t\t\t\t\t\t<td className='td1'>{a.rent_name}</td>\n\t\t\t\t\t\t\t\t\t<td className='td1'>\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ta.status === '대여가능'\n\t\t\t\t\t\t\t\t\t\t\t\t? <Badge bg=\"success\" className=\"badgeCss\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t대여가능\n\t\t\t\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t: <Badge bg=\"danger\" className='badgeCss'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t대여불가\n\t\t\t\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td className='td1'>{a.status}</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t))}\n\t\t\t\t</Table>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nexport default ListTable;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}